#!/usr/bin/env node
var debug = require('debug')('chatsocketio');
var app = require('../app');
//var io1 = require('../iofol/iofile');
app.set('port', process.env.PORT || 5000);

var server = app.listen(app.get('port'), function() {
  debug('Express server listening on port ' + server.address().port);
});
//io1.listen(server);
var io = require('socket.io').listen(server);
io.sockets.on('connection', function (socket) {
	    socket.on('setPseudo', function (data) {
	    socket.pseudo=data;
	});
	socket.on('message', function (message) {
	    
	        var data = { 'message' : message, pseudo : socket.pseudo };
	        socket.broadcast.emit('message', data);
	        console.log("user " + socket.pseudo + " send this : " + message);
	    
	});
});